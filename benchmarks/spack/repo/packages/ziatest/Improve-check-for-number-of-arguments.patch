From 41377ad3681b9e5b629ce4178e1559de3a5c85d6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mos=C3=A8=20Giordano?= <m.giordano@ucl.ac.uk>
Date: Tue, 28 Jan 2025 11:43:11 +0000
Subject: [PATCH] Improve check for number of arguments

If passing three or fewer arguments (`argc <= 3`) `argv[1]` is always
referenced, without checking whether that element actually exists, causing a
segfault.
---
 ziatest.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ziatest.c b/ziatest.c
index 2e7784c..84d4429 100644
--- a/ziatest.c
+++ b/ziatest.c
@@ -27,7 +27,7 @@ int main(int argc, char* argv[])
     char *cmd;
 
     /* check for proper usage */
-    if (argc > 3) {
+    if (argc < 2 || argc > 3) {
         printf("usage: ziatest <#procs/node> [exe_and_arg]\n");
         exit(1);
     }
-- 
2.45.2

